这篇论文提出了一种名为**TEESLICE**的新方法，旨在解决现有TEE防护的DNN分区（TSDP）方法在安全性和效率上的不足。以下是方法的详细解析：

---

### **1. 核心思路：先分割后训练（Partition-Before-Training）**
与传统TSDP的“先训练后分割”不同，TEESLICE通过**分离公共模型与隐私数据**，确保**仅隐私相关参数在TEE内**，而公共模型部分无需保护。
- **公共骨干模型 (Public Backbone)**：使用预训练模型（如ResNet18）作为基础，负责大部分非敏感计算，运行在GPU上。
- **隐私切片 (Private Slices)**：在TEE内训练轻量级切片，仅包含由隐私数据驱动的参数，作为骨干模型的补充。

---

### **2. 方法步骤详解**

#### **(1) 密集切片模型生成 (Densely Sliced Model)**
- **切片插入**：在骨干模型的层间插入多个轻量级切片（如1x1卷积层），每个切片连接相邻层。
- **重要性权重 (α)**：为每个切片分配一个动态权重α，控制其对输出的影响。
- **联合训练**：在隐私数据上同时优化切片参数和α，使切片学习隐私相关的特征。

#### **(2) 动态剪枝 (Iterative Pruning)**
- **重要性排序**：根据α值对切片排序，α越小表示该切片对模型影响越小。
- **迭代剪枝**：逐步移除低α值的切片，并微调剩余切片，直到精度损失小于阈值（如1%）。
- **稀疏切片模型 (Sparsely Sliced Model)**：最终得到仅包含关键隐私切片的轻量模型，确保TEE内计算高效。

#### **(3) 混合模型部署 (Hybrid Deployment)**
- **TEE内组件**：
  - **隐私切片**：负责处理隐私相关特征。
  - **非线形层（如ReLU）**：因难以安全卸载，留在TEE内。
- **GPU组件**：公共骨干的线性层（如卷积层）。
- **安全通信**：
  - **OTP加密**：对TEE到GPU的特征传输进行一次性掩码加密，防止中间数据泄露。
  - **Freivalds验证**：随机抽样验证GPU计算结果的正确性，防止篡改。

---

### **3. 关键技术创新**

- **动态剪枝与重要性学习**：  
  通过α权重自动识别关键隐私切片，在保证精度的同时最小化TEE计算量。

- **轻量级加密与验证**：  
  OTP加密仅需简单模运算，Freivalds算法通过矩阵乘法的随机验证，两者开销低且可抵御已知攻击。

- **非线形层保护**：  
  将激活函数等非线形层保留在TEE内，避免其成为攻击入口（如通过梯度泄露隐私）。

---

### **4. 理论保障与实验验证**

- **安全性**：  
  - 仅隐私切片接触敏感数据，公共骨干与预训练模型参数无关，阻止模型窃取。
  - 加密与验证机制确保中间数据不可逆且未被篡改。

- **效率**：  
  - 剪枝后TEE计算量降低10倍以上，GPU加速使整体推理速度提升18.37倍。
  - 在ImageNet等任务上精度损失可忽略（<0.5%）。

---

### **5. 与现有方法的对比**

| 方法                | 训练策略       | 安全性弱点                     | 计算开销     | 精度损失 |
|---------------------|--------------|------------------------------|------------|--------|
| 传统TSDP（如DarkneTZ） | 先训练后分割   | 隐私权重分散，部分暴露在GPU     | 高（需保护多参数） | 明显    |
| **TEESLICE**        | 先分割后训练   | 仅隐私切片在TEE，公共模型无敏感信息 | 低（动态剪枝） | 无     |

---

### **总结**
TEESLICE通过“先分割后训练”策略和动态剪枝技术，在保证模型精度的同时，将隐私计算严格限制在TEE内，显著提升了设备端ML的安全性与效率。该方法为TEE在真实场景中的应用提供了新的设计范式。