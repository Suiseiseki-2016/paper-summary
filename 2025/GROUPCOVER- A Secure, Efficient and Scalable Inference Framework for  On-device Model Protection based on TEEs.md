# GROUPCOVER: 基于可信执行环境的深度学习模型保护框架

## 核心 IDEA
**GROUPCOVER** 是针对模型混淆方法中**随机性脆弱性**问题的改进框架，通过三重创新提升安全性：
1. **充分随机化策略**  
   - 反向聚类分组 + 组内线性组合，破坏卷积核统计特征
2. **相互覆盖混淆**  
   - 每个卷积核被替换为组内其他核的随机线性组合，规避相似性分析
3. **轻量级计算开销**  
   - TEE 预处理仅增加 **19%** 计算开销，精度损失约 **0.01%**

---

## 核心算法
### 1. 预处理阶段（Offline Preprocessing）
**反向聚类（Inverse Clustering）**  
- 按卷积核间**余弦相似度最大距离**分组（默认组大小 $g=4$）  
- 对权重矩阵 $W = [w_1, w_2, \dots, w_n]$ 执行算法1，实现组内差异最大化  

**线性组合与置换**  
对每组卷积核 $\{w_{i1}, w_{i2}, w_{i3}, w_{i4}\}$：  
1. 生成随机可逆矩阵 $A \in \mathbb{R}^{4 \times 4}$  
2. 执行线性变换：  
$$
\begin{bmatrix}
w'_{i1} \\ 
w'_{i2} \\ 
w'_{i3} \\ 
w'_{i4}
\end{bmatrix}
= A \cdot 
\begin{bmatrix}
w_{i1} \\ 
w_{i2} \\ 
w_{i3} \\ 
w_{i4}
\end{bmatrix}
$$  
3. 全层权重随机置换 $W' = P_\pi(W')$

### 2. 推理阶段（Online Inference）
**TEE-GPU 协同计算流程**  
1. **输入掩码**：TEE 计算 $X' = X + R$（$R$ 为一次性随机掩码）  
2. **混淆计算**：GPU 执行 $Y' = \text{Conv}(W', X')$  
3. **结果还原**：TEE 解密 $Y = f_o^{-1}(Y' - \text{Conv}(W', R))$，其中：  
   - $f_o^{-1} = P_\pi^{-1} \circ A^{-1}$

### 3. 安全性设计
| 威胁类型       | 防御机制                          | 攻击成功率对比       |
|----------------|-----------------------------------|----------------------|
| 统计特征分析   | 线性组合破坏权重分布              | 仅 17.3%~31.2% 恢复 |
| 逆向攻击       | 组内相互覆盖混淆                  | 1.03×黑盒基准       |
| 模型窃取       | TEE 保护权重与激活值              | 安全性提升 3 倍     |

---

## 实验效果
### 性能指标
- **安全性**  
  - CIFAR10/100 模型功能恢复率：**17.3%~31.2%**（对比无保护模型的 84%~94%）
- **效率**  
  - 推理吞吐量：纯 GPU 的 **32%**  
  - 额外开销：**19%**（主要来自 TEE-GPU 通信）
- **扩展性**  
  - 支持架构：AlexNet / ResNet / VGG  
  - 预处理时间：**<10秒**（无需重训练）

---

## 关键公式总结
**权重混淆变换**  
$$\forall \text{ 组 } G_i,\ W'_i = A_i \cdot W_i \cdot P_\pi$$

**输出解密过程**  
$$Y = P_\pi^{-1} \cdot A^{-1} \cdot (Y' - W' \ast R)$$
